<!DOCTYPE html>
<html>
  <!-- ヘッダーのスクリプト群の読み込み -->
  <%- include('./ejs-components/sample/header.ejs') %>
  <body>
    <div id="vue-root">
      <!-- audio: trueを付与すると音声も取り入れられるけど、動作が重くなる問題があるので、コメントアウト -->
      <a-scene
        networked-scene="
          room: dev;
          debug: true;
          adapter: webrtc;
        "
      >
        <a-assets>
          <!-- 作品のサムネイルの読み込み -->
          <% exhibits.forEach(function(exhibit) { %>
          <img
            id="asset-exhibit-thumbnail-<%=exhibit.id%>"
            src="<%=exhibit.thumbnail%>"
            crossorigin="anonymous"
          />
          <% }) %>

          <img
            id="grid"
            src="https://img.gs/bbdkhfbzkk/stretch/https://i.imgur.com/25P1geh.png"
            crossorigin="anonymous"
          />
          <img
            id="sky"
            src="/honnban/assets/img/sky.jpg"
            crossorigin="anonymous"
          />

          <!-- アバター -->
          <template id="avatar-template">
            <a-entity class="avatar">
              <a-sphere
                class="head"
                color="#ffffff"
                scale="0.45 0.5 0.4"
              ></a-sphere>
              <a-entity class="face" position="0 0.05 0">
                <a-sphere
                  class="eye"
                  color="#efefef"
                  position="0.16 0.1 -0.35"
                  scale="0.12 0.12 0.12"
                >
                  <a-sphere
                    class="pupil"
                    color="#000"
                    position="0 0 -1"
                    scale="0.2 0.2 0.2"
                  ></a-sphere>
                </a-sphere>
                <a-sphere
                  class="eye"
                  color="#efefef"
                  position="-0.16 0.1 -0.35"
                  scale="0.12 0.12 0.12"
                >
                  <a-sphere
                    class="pupil"
                    color="#000"
                    position="0 0 -1"
                    scale="0.2 0.2 0.2"
                  ></a-sphere>
                </a-sphere>
              </a-entity>
            </a-entity>
          </template>
          <img id="footsteps" src="/honnban/assets/img/footsteps.png" />
          <img id="black" src="/honnban/assets/img/black.png" />
        </a-assets>

        <!-- 赤ボックス | クリックするとテレポートされる -->
        <a-box
          color="#AA0000"
          position="-3 0.5 4"
          class="clickable"
          blink-teleportation="pos: -2 1.6 4"
        >
        </a-box>

        <!-- 緑ボックス | クリックしてテレポート | クリックされたあと、消えるよ -->
        <a-box
          color="#00AA00"
          position="3 0.5 4"
          class="clickable"
          blink-teleportation="pos: 2 1.6 4; hide: true"
        >
        </a-box>

        <!-- 黄色ボックス -->
        <a-box color="#FFAA00" position="-3 0.5 -4"> </a-box>
        <!-- クリックしてテレポート | クリックされたあと、消えるよ -->
        <a-image
          src="#footsteps"
          position="-3 2.5 -4"
          look-at="#player"
          class="clickable"
          blink-teleportation="pos: -2 1.6 -4; hide: true"
        >
        </a-image>

        <!-- 青ボックス -->
        <a-box color="#0077FF" position="3 0.5 -4"> </a-box>
        <!-- クリックしてテレポート -->
        <a-image
          src="#footsteps"
          position="3 2.5 -4"
          look-at="#player"
          class="clickable"
          blink-teleportation="pos: 2 1.6 -4"
        >
        </a-image>

        <!-- 床 -->
        <a-entity
          position="0 0 0"
          geometry="primitive: plane; width: 10000; height: 10000;"
          rotation="-90 0 0"
          material="src: #grid; repeat: 10000 10000; transparent: true; metalness:0.6; roughness: 0.4; sphericalEnvMap: #sky;"
        ></a-entity>

        <!-- 何らかの視覚効果のようだ -->
        <a-entity
          light="color: #ccccff; intensity: 1; type: ambient;"
          visible=""
        ></a-entity>
        <a-entity
          light="color: #ffaaff; intensity: 1.5"
          position="5 5 5"
        ></a-entity>

        <!-- 空なのだ -->
        <a-sky src="#sky" rotation="0 -90 0"></a-sky>
        <!-- 粒子効果なのだ -->
        <a-entity id="particles" particle-system="preset: snow"></a-entity>

        <!-- API通信の結果を反映した画像表示サンプル -->
        <% exhibits.forEach(function(exhibit) { %>
        <a-image
          src="#asset-exhibit-thumbnail-<%=exhibit.id%>"
          scale="2 2 1"
          position="0 1 <%=exhibit.id%>"
        >
        </a-image>
        <% }) %>

        <!-- 日本語のサンプルなのだ -->
        <a-text
          value="こんにちは世界！"
          font="/honnban/assets/fonts/noto-sans-cjk-jp/noto-sans-cjk-jp-msdf.json"
          font-image="/honnban/assets/fonts/noto-sans-cjk-jp/noto-sans-cjk-jp-msdf.png"
          negate="false"
          scale="2 2 1"
          position="0 1 -4"
        >
        </a-text>

        <!-- カメラ（なんか、a-sceneの最後の方に置いた方がいいらしい） -->
        <a-camera
          id="player"
          position="0 1.6 0"
          networked="template:#avatar-template;attachTemplateToLocal:false;"
          spawn-in-circle="radius:3"
          wasd-controls
          look-controls
        >
          <!-- SELECTIVE INTERSECTIONS -->
          <a-cursor raycaster="objects: .clickable"></a-cursor>
          <a-sphere class="head" visible="false" random-color></a-sphere>
        </a-camera>
      </a-scene>
    </div>

    <!-- フッター部分のスクリプトの読み込み -->
    <%- include('./ejs-components/sample/footer.ejs') %>
  </body>
</html>
